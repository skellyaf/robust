function A = r2bp_stt3_dHessian(x, mu)
x_state = x;
% r = [x(1); x(2); x(3)];
% v = [x(4); x(5); x(6)];

x = x_state(1);
y = x_state(2);
z = x_state(3);
% norm_r = norm(r);
% ur = r/norm_r;





Uxx =[(3*mu*(8*x^4 - 24*x^2*y^2 - 24*x^2*z^2 + 3*y^4 + 6*y^2*z^2 + 3*z^4))/(x^2 + y^2 + z^2)^(9/2),                             -(15*mu*x*y*(- 4*x^2 + 3*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(9/2),                             -(15*mu*x*z*(- 4*x^2 + 3*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(9/2);
                              -(15*mu*x*y*(- 4*x^2 + 3*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(9/2), -(3*mu*(4*x^4 - 27*x^2*y^2 + 3*x^2*z^2 + 4*y^4 + 3*y^2*z^2 - z^4))/(x^2 + y^2 + z^2)^(9/2),                                 -(15*mu*y*z*(- 6*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(9/2);
                              -(15*mu*x*z*(- 4*x^2 + 3*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(9/2),                                 -(15*mu*y*z*(- 6*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(9/2), -(3*mu*(4*x^4 + 3*x^2*y^2 - 27*x^2*z^2 - y^4 + 3*y^2*z^2 + 4*z^4))/(x^2 + y^2 + z^2)^(9/2)];
 

 
Uyy =[-(3*mu*(4*x^4 - 27*x^2*y^2 + 3*x^2*z^2 + 4*y^4 + 3*y^2*z^2 - z^4))/(x^2 + y^2 + z^2)^(9/2),                                 -(15*mu*x*y*(3*x^2 - 4*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(9/2),                                     -(15*mu*x*z*(x^2 - 6*y^2 + z^2))/(x^2 + y^2 + z^2)^(9/2);
                              -(15*mu*x*y*(3*x^2 - 4*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(9/2), (3*mu*(3*x^4 - 24*x^2*y^2 + 6*x^2*z^2 + 8*y^4 - 24*y^2*z^2 + 3*z^4))/(x^2 + y^2 + z^2)^(9/2),                                 -(15*mu*y*z*(3*x^2 - 4*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(9/2);
                                  -(15*mu*x*z*(x^2 - 6*y^2 + z^2))/(x^2 + y^2 + z^2)^(9/2),                                 -(15*mu*y*z*(3*x^2 - 4*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(9/2), -(3*mu*(- x^4 + 3*x^2*y^2 + 3*x^2*z^2 + 4*y^4 - 27*y^2*z^2 + 4*z^4))/(x^2 + y^2 + z^2)^(9/2)];
 

 
Uzz =[-(3*mu*(4*x^4 + 3*x^2*y^2 - 27*x^2*z^2 - y^4 + 3*y^2*z^2 + 4*z^4))/(x^2 + y^2 + z^2)^(9/2),                                     -(15*mu*x*y*(x^2 + y^2 - 6*z^2))/(x^2 + y^2 + z^2)^(9/2),                                 -(15*mu*x*z*(3*x^2 + 3*y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(9/2);
                                  -(15*mu*x*y*(x^2 + y^2 - 6*z^2))/(x^2 + y^2 + z^2)^(9/2), -(3*mu*(- x^4 + 3*x^2*y^2 + 3*x^2*z^2 + 4*y^4 - 27*y^2*z^2 + 4*z^4))/(x^2 + y^2 + z^2)^(9/2),                                 -(15*mu*y*z*(3*x^2 + 3*y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(9/2);
                              -(15*mu*x*z*(3*x^2 + 3*y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(9/2),                                 -(15*mu*y*z*(3*x^2 + 3*y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(9/2), (3*mu*(3*x^4 + 6*x^2*y^2 - 24*x^2*z^2 + 3*y^4 - 24*y^2*z^2 + 8*z^4))/(x^2 + y^2 + z^2)^(9/2)];
 








A = zeros(6,6,6);
A(4:6,1:3,1) = Uxx;

A(4:6,1:3,2) = Uyy;

A(4:6,1:3,3) = Uzz;

end