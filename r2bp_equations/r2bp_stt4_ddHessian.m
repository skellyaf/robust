function A = r2bp_stt4_ddHessian(x, mu)
x_state = x;
% r = [x(1); x(2); x(3)];
% v = [x(4); x(5); x(6)];

x = x_state(1);
y = x_state(2);
z = x_state(3);
% norm_r = norm(r);
% ur = r/norm_r;


Uxxx = [-(15*mu*x*(8*x^4 - 40*x^2*y^2 - 40*x^2*z^2 + 15*y^4 + 30*y^2*z^2 + 15*z^4))/(x^2 + y^2 + z^2)^(11/2),   -(45*mu*y*(8*x^4 - 12*x^2*y^2 - 12*x^2*z^2 + y^4 + 2*y^2*z^2 + z^4))/(x^2 + y^2 + z^2)^(11/2),   -(45*mu*z*(8*x^4 - 12*x^2*y^2 - 12*x^2*z^2 + y^4 + 2*y^2*z^2 + z^4))/(x^2 + y^2 + z^2)^(11/2);
       -(45*mu*y*(8*x^4 - 12*x^2*y^2 - 12*x^2*z^2 + y^4 + 2*y^2*z^2 + z^4))/(x^2 + y^2 + z^2)^(11/2), (15*mu*x*(4*x^4 - 41*x^2*y^2 + x^2*z^2 + 18*y^4 + 15*y^2*z^2 - 3*z^4))/(x^2 + y^2 + z^2)^(11/2),                                   (315*mu*x*y*z*(- 2*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(11/2);
       -(45*mu*z*(8*x^4 - 12*x^2*y^2 - 12*x^2*z^2 + y^4 + 2*y^2*z^2 + z^4))/(x^2 + y^2 + z^2)^(11/2),                                   (315*mu*x*y*z*(- 2*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(11/2), (15*mu*x*(4*x^4 + x^2*y^2 - 41*x^2*z^2 - 3*y^4 + 15*y^2*z^2 + 18*z^4))/(x^2 + y^2 + z^2)^(11/2)];
 

 
Uyyy = [(15*mu*y*(18*x^4 - 41*x^2*y^2 + 15*x^2*z^2 + 4*y^4 + y^2*z^2 - 3*z^4))/(x^2 + y^2 + z^2)^(11/2),        -(45*mu*x*(x^4 - 12*x^2*y^2 + 2*x^2*z^2 + 8*y^4 - 12*y^2*z^2 + z^4))/(x^2 + y^2 + z^2)^(11/2),                                       (315*mu*x*y*z*(x^2 - 2*y^2 + z^2))/(x^2 + y^2 + z^2)^(11/2);
  -(45*mu*x*(x^4 - 12*x^2*y^2 + 2*x^2*z^2 + 8*y^4 - 12*y^2*z^2 + z^4))/(x^2 + y^2 + z^2)^(11/2), -(15*mu*y*(15*x^4 - 40*x^2*y^2 + 30*x^2*z^2 + 8*y^4 - 40*y^2*z^2 + 15*z^4))/(x^2 + y^2 + z^2)^(11/2),     -(45*mu*z*(x^4 - 12*x^2*y^2 + 2*x^2*z^2 + 8*y^4 - 12*y^2*z^2 + z^4))/(x^2 + y^2 + z^2)^(11/2);
                                    (315*mu*x*y*z*(x^2 - 2*y^2 + z^2))/(x^2 + y^2 + z^2)^(11/2),        -(45*mu*z*(x^4 - 12*x^2*y^2 + 2*x^2*z^2 + 8*y^4 - 12*y^2*z^2 + z^4))/(x^2 + y^2 + z^2)^(11/2), (15*mu*y*(- 3*x^4 + x^2*y^2 + 15*x^2*z^2 + 4*y^4 - 41*y^2*z^2 + 18*z^4))/(x^2 + y^2 + z^2)^(11/2)];
 
 
Uzzz = [(15*mu*z*(18*x^4 + 15*x^2*y^2 - 41*x^2*z^2 - 3*y^4 + y^2*z^2 + 4*z^4))/(x^2 + y^2 + z^2)^(11/2),                                       (315*mu*x*y*z*(x^2 + y^2 - 2*z^2))/(x^2 + y^2 + z^2)^(11/2),        -(45*mu*x*(x^4 + 2*x^2*y^2 - 12*x^2*z^2 + y^4 - 12*y^2*z^2 + 8*z^4))/(x^2 + y^2 + z^2)^(11/2);
                                    (315*mu*x*y*z*(x^2 + y^2 - 2*z^2))/(x^2 + y^2 + z^2)^(11/2), (15*mu*z*(- 3*x^4 + 15*x^2*y^2 + x^2*z^2 + 18*y^4 - 41*y^2*z^2 + 4*z^4))/(x^2 + y^2 + z^2)^(11/2),        -(45*mu*y*(x^4 + 2*x^2*y^2 - 12*x^2*z^2 + y^4 - 12*y^2*z^2 + 8*z^4))/(x^2 + y^2 + z^2)^(11/2);
  -(45*mu*x*(x^4 + 2*x^2*y^2 - 12*x^2*z^2 + y^4 - 12*y^2*z^2 + 8*z^4))/(x^2 + y^2 + z^2)^(11/2),     -(45*mu*y*(x^4 + 2*x^2*y^2 - 12*x^2*z^2 + y^4 - 12*y^2*z^2 + 8*z^4))/(x^2 + y^2 + z^2)^(11/2), -(15*mu*z*(15*x^4 + 30*x^2*y^2 - 40*x^2*z^2 + 15*y^4 - 40*y^2*z^2 + 8*z^4))/(x^2 + y^2 + z^2)^(11/2)];
 








A = zeros(6,6,6);
A(4:6,1:3,1) = Uxxx;

A(4:6,1:3,2) = Uyyy;

A(4:6,1:3,3) = Uzzz;

end