function A = r2bp_stt2_tensor(x, mu)
x_state = x;
% r = [x(1); x(2); x(3)];
% v = [x(4); x(5); x(6)];

x = x_state(1);
y = x_state(2);
z = x_state(3);
% norm_r = norm(r);
% ur = r/norm_r;


Ux =[(3*mu*x*(- 2*x^2 + 3*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(7/2), (3*mu*y*(- 4*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2), (3*mu*z*(- 4*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2);
    (3*mu*y*(- 4*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2),   (3*mu*x*(x^2 - 4*y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2),                 -(15*mu*x*y*z)/(x^2 + y^2 + z^2)^(7/2);
    (3*mu*z*(- 4*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2),                 -(15*mu*x*y*z)/(x^2 + y^2 + z^2)^(7/2),   (3*mu*x*(x^2 + y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(7/2)];
 
Uy =[(3*mu*y*(- 4*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2),     (3*mu*x*(x^2 - 4*y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2),               -(15*mu*x*y*z)/(x^2 + y^2 + z^2)^(7/2);
  (3*mu*x*(x^2 - 4*y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2), (3*mu*y*(3*x^2 - 2*y^2 + 3*z^2))/(x^2 + y^2 + z^2)^(7/2), (3*mu*z*(x^2 - 4*y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2);
                -(15*mu*x*y*z)/(x^2 + y^2 + z^2)^(7/2),     (3*mu*z*(x^2 - 4*y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2), (3*mu*y*(x^2 + y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(7/2)];
 

Uz =[(3*mu*z*(- 4*x^2 + y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2),               -(15*mu*x*y*z)/(x^2 + y^2 + z^2)^(7/2),     (3*mu*x*(x^2 + y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(7/2);
               -(15*mu*x*y*z)/(x^2 + y^2 + z^2)^(7/2), (3*mu*z*(x^2 - 4*y^2 + z^2))/(x^2 + y^2 + z^2)^(7/2),     (3*mu*y*(x^2 + y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(7/2);
  (3*mu*x*(x^2 + y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(7/2), (3*mu*y*(x^2 + y^2 - 4*z^2))/(x^2 + y^2 + z^2)^(7/2), (3*mu*z*(3*x^2 + 3*y^2 - 2*z^2))/(x^2 + y^2 + z^2)^(7/2)];
 


A = zeros(6,6,6);
A(4:6,1:3,1) = Ux;

A(4:6,1:3,2) = Uy;

A(4:6,1:3,3) = Uz;

end